<?xml version = "1.0" encoding = "UTF-8" ?>
<odoo>
    <!--    Sale order report action-->
    <record id="action_report_sale_order" model="ir.actions.report">
   <field name="name">Sale Order</field>
   <field name="model">room.booking</field>
   <field name="report_type">qweb-pdf</field>
   <field name="report_name">hotel_management_odoo.report_sale_order</field>
   <field name="report_file">hotel_management_odoo.report_sale_order</field>
   <field name="binding_model_id" ref="model_room_booking"/>
   <field name="binding_type">report</field>
</record>
    <template id="report_sale_order">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
               <div class="page">
                    <div class="oe_structure"/>
                    <h2>Rapport des ventes pour la periode du <span t-esc="datas['checkin_date']" t-options="{&quot;widget&quot;: &quot;date&quot;}"/>
                                 AU
                                <span t-esc="datas['checkout_date']" t-options="{&quot;widget&quot;: &quot;date&quot;}"/>
                                <br/></h2>
                    <br/>

                    <center>  <h3>HEBERGEMENTS  </h3></center>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Type</th>
                                <th>PU</th>
                                <th>Quantit√©</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <t t-set="index" t-value="1"/>
                        <t t-set="sum_total" t-value="0"/>

                    <tr t-foreach="booking_details" t-as="line" class="border-black">
                            <td class="text-left"><span t-esc="index"/></td>
                            <!--<td class="text-left">NUITE/SIESTE</td>-->


                            <t t-if="prices[index] &gt;=10000">
                                <td>NUITE</td>
                            </t>
                            <t t-else="">
                              <td>SIESTE</td>
                            </t>

                            <!--<td class="text-left">  <span t-esc="'{:,.0f}'.format(line['list_price']).replace(',', ' ')"/> </td>-->
                            <!--<td class="text-left">  <span t-esc="'{:,.0f}'.format(line['uom_qty']).replace(',', ' ')"/> </td>-->

                            <td class="text-left">  <span t-esc="'{:,.0f}'.format(prices[index]).replace(',', ' ')"/> </td>
                            <td class="text-left">  <span t-esc="'{:,.0f}'.format(qtys[index]).replace(',', ' ')"/> </td>

                            <!--<td class="text-left">  <span t-esc="'{:,.0f}'.format(line['list_price']*line['uom_qty]).replace(',', ' ')"/> </td>-->


                            <td class="text-left">  <span t-esc="'{:,.0f}'.format(prices[index]*qtys[index]).replace(',', ' ')"/> </td>

                            <t t-set="index" t-value="index+1"/>
                            <t t-set="sum_total" t-value=" sum_total + prices[index]*qtys[index]"/>

                    </tr>

                        <tr class="border-black o_subtotal">
                          <td colspan="4">
                          <b>CA HEBERGEMENTS</b></td>
                          <td class="text-right" colspan="2">
                              <h5>    <span t-esc="'{:,.0f}'.format(sum_total).replace(',', ' ')"/>  FCFA</h5>
                          </td>
                        </tr>

                    </table>

                    <center>  <h2>RESTAURANT  </h2>
                     <table class="table">
                      <tr>
                        <td>  <b>CA Boisson </b></td>
                        <td>  <b> 000000000000 :  FCFA </b></td>
                      </tr>
                      <tr>
                        <td>  <b>CA Nouriture </b></td>
                        <td>  <b> 000000000000 :  FCFA </b></td>
                      </tr>

                       <tr>
                        <td>  <b>CA RESTAURANT : </b></td>
                        <td>  <b> <span t-esc="'{:,.0f}'.format(total_resto).replace(',', ' ')"/> FCFA </b></td>
                      </tr>

                      </table>

                       <h2>SERVICES</h2>
                      <table class="table">
                      <tr>
                        <td>  <b>CA PISCINE </b></td>
                        <td>  <b> 000000000000 :  FCFA </b></td>
                      </tr>
                      <tr>
                        <td>  <b>CA SALLE </b></td>
                        <td>  <b> 000000000000 :  FCFA </b></td>
                      </tr>

                       <tr>
                        <td>  <b>CA  TOTAL SERVICES </b></td>
                        <td>  <b> <span t-esc="'{:,.0f}'.format(total_service).replace(',', ' ')"/> :  FCFA </b></td>
                      </tr>

                      </table>



                   <h2>SORTIES</h2>
                   <table class="table">
                     <tr> <td>Sorties</td>

                          <td> <span t-esc="'{:,.0f}'.format(total_sortie).replace(',', ' ')"/>   FCFA </td>


                     </tr>
                     </table>


                    <h2> BILAN</h2>
                    <table class="table">
                      <tr>
                        <td>  <b>CA TOTAL </b></td>
                        <td>  <b> 000000000000 :  FCFA </b></td>
                      </tr>
                      <tr>
                        <td>  <b>TOTAL Sorties </b></td>
                        <td>  <b>     <span t-esc="'{:,.0f}'.format(total_sortie).replace(',', ' ')"/>    FCFA </b></td>
                      </tr>

                       <tr>
                        <td>  <b>BENEFICES REALISES </b></td>
                        <td>  <b> <span t-esc="'{:,.0f}'.format(total_sortie-1000).replace(',', ' ')"/>   FCFA </b></td>
                      </tr>

                      </table>

                    </center>
                </div>
            </t>
        </t>
    </template>

</odoo>
